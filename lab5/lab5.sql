CREATE DATABASE lab5;
USE  lab5;
CREATE TABLE DEPT (
    DEPTNO INT PRIMARY KEY,
    DNAME VARCHAR(50) NOT NULL,
    DLOC VARCHAR(50)
    );
CREATE TABLE EMPLOYEE (
    EMPNO INT PRIMARY KEY,
    ENAME VARCHAR(50) NOT NULL,
    MGR_NO INT,
    HIREDATE DATE,
    SAL DECIMAL(10,2),
    DEPTNO INT,
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO),
    FOREIGN KEY (MGR_NO) REFERENCES EMPLOYEE(EMPNO)
);
CREATE TABLE PROJECT (
    PNO INT PRIMARY KEY,
    PLOC VARCHAR(50),
    PNAME VARCHAR(100) NOT NULL
);
CREATE TABLE ASSIGNED_TO (
    EMPNO INT,
    PNO INT,
    JOB_ROLE VARCHAR(50),
	PRIMARY KEY (EMPNO, PNO),
	FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO),
	FOREIGN KEY (PNO) REFERENCES PROJECT(PNO)
);
CREATE TABLE INCENTIVES (
    EMPNO INT,
    INCENTIVE_DATE DATE,
    INCENTIVE_AMOUNT DECIMAL(10,2),
    PRIMARY KEY (EMPNO, INCENTIVE_DATE),
    FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO)
);
INSERT INTO DEPT VALUES (10, 'Research', 'Bengaluru');
INSERT INTO DEPT VALUES (20, 'Development', 'Hyderabad');
INSERT INTO DEPT VALUES (30, 'Marketing', 'Mysuru');
INSERT INTO DEPT VALUES (40, 'Sales', 'Bengaluru');
INSERT INTO DEPT VALUES (50, 'HR', 'Chennai');
INSERT INTO DEPT VALUES (60, 'Finance', 'Mumbai');

INSERT INTO EMPLOYEE VALUES (1001, 'Rajesh ', NULL, '2020-01-15', 75000, 10);
INSERT INTO EMPLOYEE VALUES (1002, 'Priya ', 1001, '2020-03-20', 65000, 10);
INSERT INTO EMPLOYEE VALUES (1003, 'Amit', 1001, '2021-05-10', 55000, 20);
INSERT INTO EMPLOYEE VALUES (1004, 'Sneha', NULL, '2019-11-05', 80000, 20);
INSERT INTO EMPLOYEE VALUES (1005, 'Vikram', 1004, '2021-08-22', 60000, 30);
INSERT INTO EMPLOYEE VALUES (1006, 'Ananya ', 1004, '2022-02-14', 58000, 40);
INSERT INTO EMPLOYEE VALUES (1007, 'Karthik', 1001, '2020-07-18', 62000, 50);

INSERT INTO PROJECT VALUES (101, 'Bengaluru', 'AI Research Project');
INSERT INTO PROJECT VALUES (102, 'Hyderabad', 'Cloud Migration');
INSERT INTO PROJECT VALUES (103, 'Mysuru', 'Mobile App Development');
INSERT INTO PROJECT VALUES (104, 'Bengaluru', 'Data Analytics Platform');
INSERT INTO PROJECT VALUES (105, 'Chennai', 'Cybersecurity Enhancement');
INSERT INTO PROJECT VALUES (106, 'Mumbai', 'ERP Implementation');

INSERT INTO ASSIGNED_TO VALUES (1001, 101, 'Project Manager');
INSERT INTO ASSIGNED_TO VALUES (1002, 101, 'Senior Developer');
INSERT INTO ASSIGNED_TO VALUES (1003, 102, 'Tech Lead');
INSERT INTO ASSIGNED_TO VALUES (1004, 102, 'Architect');
INSERT INTO ASSIGNED_TO VALUES (1005, 103, 'Developer');
INSERT INTO ASSIGNED_TO VALUES (1006, 104, 'Business Analyst');
INSERT INTO ASSIGNED_TO VALUES (1007, 105, 'Security Engineer');

INSERT INTO INCENTIVES VALUES (1001, '2023-06-30', 15000);
INSERT INTO INCENTIVES VALUES (1002, '2023-06-30', 12000);
INSERT INTO INCENTIVES VALUES (1003, '2023-12-31', 10000);
INSERT INTO INCENTIVES VALUES (1004, '2023-06-30', 18000);
INSERT INTO INCENTIVES VALUES (1006, '2024-01-15', 8000);
INSERT INTO INCENTIVES VALUES (1007, '2023-12-31', 11000);

SELECT DISTINCT  e.EMPNO
FROM EMPLOYEE e
JOIN ASSIGNED_TO a ON e.EMPNO = a.EMPNO
JOIN PROJECT p ON a.PNO = p.PNO
WHERE p.PLOC IN ('Bengaluru', 'Hyderabad', 'Mysuru');

